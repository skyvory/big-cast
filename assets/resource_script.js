function callErrorNotification(e){var i='<div class="alert alert-danger error-notification">'+e+"</div>";$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".error-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}function callResourceList(e){var i=$.ajax({url:config.base+"index.php/resource/loadResource",type:"POST",data:{type:e},dataType:"html",beforeSend:function(){$(".request-loading-resourcelist").show()}});if(i.done(function(e){$(".request-loading-resourcelist").hide(),$(".resource-list").html(e)}),1==e){var a='<div class="row"><div class="col-md-10 sprite-input-append"><p>Fill the Character and Pose Name before dropping your files</p><form class="form-inline"><label for="charactername">Character name</label> <input type="text" id="charactername" name="character_name" value="" /> <label for="figurename">Pose name</label> <input type="text" id="figurename" name="figure_name" value="" /></form></div></div>';$(".resource-preinput").html(a)}else $(".resource-preinput").html("")}$(function(){$("#fileupload").fileupload({url:config.base+"index.php/resource/do_upload",dataType:"json",progressall:function(e,i){var a=parseInt(i.loaded/i.total*100,10);$("#progress .bar").slideDown(500).css("width",a+"%")},stop:function(){$("#progress .bar").delay(500).slideUp(500)},done:function(e,i){$.each(i.result.files,function(e,i){if(i.error&&callErrorNotification(i.error),"1"==i.resource_type){var a='<div class="media sprite-media"> <div class="media-left sprite-thumbnail-area"> <img src="'+i.url+'" class="media-object resource-thumbnail" /> </div> <div class="media-body"> <div class="resource-property"> <form class="form-horizontal sprite-form"> <div class="form-group"> <label for="spritecharactername_'+i.id+'" class="col-sm-3 control-label">Character Name</label> <div class="col-sm-5"> <input type="text" id="spritecharactername_'+i.id+'" name="sprite_character" class="form-control input-sm" value="'+i.character_name+'" /> </div> </div> <div class="form-group"> <label for="spritefigurename_'+i.id+'" class="col-sm-3 control-label">Pose Name</label> <div class="col-sm-5"> <input type="text" id="spritefigurename_'+i.id+'" name="sprite_figure" class="form-control input-sm" value="'+i.figure_name+'" /> </div> </div> <div class="form-group"> <label for="spriteexpressionname_'+i.id+'" class="col-sm-3 control-label">Expression Name</label> <div class="col-sm-5"> <input type="text" id="spriteexpressionname_'+i.id+'" name="sprite_expression" class="form-control input-sm" /> </div> </div> <input type="hidden" id="spriteid_'+i.id+'" name="sprite_id" value="'+i.id+'" /> <button type="button" class="btn btn-primary sprite-form-submit-button">Change</button> <button type="button" class="btn btn-danger sprite-form-delete-button" tabindex="-1">Delete</button> </form> </div> </div> </div>';$(a).appendTo(".resource-list")}else if(2==i.resource_type){var a='<div class="media background-media"> <div class="media-left background-thumbnail-area"> <img src="'+i.url+'" class="media-object resource-thumbnail" /> </div> <div class="media-body"> <div class="resource-property"> <form class="form-inline background-form"> <div class="form-group"> <label for="backgroundname_'+i.id+'">Name &nbsp;</label> <input type="text" id="backgroundname_'+i.id+'" name="background_name" class="form-control input-sm" value="'+i.name+'" /> </div> <input type="hidden" id="backgroundid_'+i.id+'" name="background_id" value="'+i.id+'" /> <button type="button" class="btn btn-primary background-form-submit-button">Change</button> <button type="button" class="btn btn-danger background-form-delete-button">Delete</button> </form> </div> </div> </div>';$(a).appendTo(".resource-list")}else if(3==i.resource_type){var a='<tr><td> <div class="media bgm-media"> <div class="media-left audio-thumbnail-area"> <img src="'+config.base+'assets/images/musical_note-512.png" class="media-object resource-thumbnail"/> </div> <div class="media-body"> <div class="resource-property"> <div class="audio-player-area"> <audio controls preload="auto"> <source src="'+i.url+'"> </audio> </div> <form class="form-inline audio-inline-form"> <div class="form-group bgm-form"> <label for="bgmname_'+i.id+'">Name &nbsp;</label> <input type="text" id="bgmname_'+i.id+'" name="bgm_name" class="form-control input-xs" value="'+i.name+'" /> </div> <input type="hidden" id="bgmid_'+i.id+'" name="bgm_id" value="'+i.id+'" /> <button type="button" class="btn btn-primary bgm-form-submit-button">Change</button> <button type="button" class="btn btn-danger bgm-form-delete-button">Delete</button> </form> </div> </div> </div> </td></tr>';$(a).appendTo(".resource-list table tbody")}else if(4==i.resource_type){var a='<div class="media sfx-media"> <div class="media-left audio-thumbnail-area"> <img src="'+config.base+'assets/images/Audio-512.png" class="media-object resource-thumbnail"/> </div> <div class="media-body"> <div class="resource-property"> <div class="audio-player-area"> <audio controls preload="auto"> <source src="'+i.url+'"> </audio> </div> <form class="form-inline audio-inline-form"> <div class="form-group sfx-form"> <label for="sfxname_'+i.id+'">Name &nbsp;</label> <input type="text" id="sfxname_'+i.id+'" name="sfx_name" class="form-control input-xs" value="'+i.name+'" /> </div> <input type="hidden" id="sfxid_'+i.id+'" name="sfx_id" value="'+i.id+'" /> <button type="button" class="btn btn-primary sfx-form-submit-button">Change</button> <button type="button" class="btn btn-danger sfx-form-delete-button">Delete</button> </form> </div> </div> </div>';$(a).appendTo(".resource-list table tbody")}else if(5==i.resource_type){var a='<tr><td> <div class="media voice-media"> <div class="media-left audio-thumbnail-area"> <img src="'+config.base+'assets/images/microphone-2-512.png" class="media-object resource-thumbnail"/> </div> <div class="media-body"> <div class="resource-property"> <div class="audio-player-area"> <audio controls preload="auto" class="audio-player"> <source src="'+i.url+'"> </audio> </div> <form class="form-inline audio-inline-form"> <div class="form-group"> <label for="voicename_'+i.id+'">Name &nbsp;</label> <input type="text" id="voicename_'+i.id+'" name="voice_name" class="form-control input-xs" value="'+i.name+'" /> </div> <div class="form-group"><input type="hidden" id="voiceid_'+i.id+'" name="voice_id" value="'+i.id+'" /> <button type="button" class="btn btn-primary voice-form-submit-button">Change</button> <button type="button" class="btn btn-danger voice-form-delete-button">Delete</button> </form> </div> </div> </div> </td></tr>';$(a).appendTo(".resource-list table tbody")}else if(6==i.resource_type){var a='<tr><td> <div class="media video-media"> <div class="media-left video-player-area"> <video controls width="300" height="225" class="video-player" preload="auto"> <video src="'+i.url+'"> </video> </div> <div class="media-body media-middle"> <div class="resource-property"> <form class="form-inline"> <div class="form-group"> <label for="videoname_'+i.id+'">Name &nbsp;</label> <input type="text" id="videoname_'+i.id+'" name="video_name" class="form-control input-sm" value="'+i.name+'" /> </div> <input type="hidden" id="videoid_'+i.id+'" name="video_id" value="'+i.id+'" /> <button type="button" class="btn btn-primary video-form-submit-button">Change</button> <button type="button" class="btn btn-danger video-form-delete-button">Delete</button> </form> </div> </div> </div> </td></tr>';$(a).appendTo(".resource-list table tbody")}})},fail:function(){callErrorNotification("Upload failed! Try again!")}}),$("#fileupload").bind("fileuploadsubmit",function(e,i){var a=$("#resourcetype"),t=$("#charactername"),o=$("#figurename");return i.formData=1==a.val()?{restype:a.val(),charname:t.val(),figname:o.val()}:{restype:a.val()},i.formData.restype?void 0:!1})});var restype=$("#resourcetype");$("#spritebutton").click(function(){restype.val("1"),callResourceList(1)}),$("#backgroundbutton").click(function(){restype.val("2"),callResourceList(2)}),$("#bgmbutton").click(function(){restype.val("3"),callResourceList(3)}),$("#sfxbutton").click(function(){restype.val("4"),callResourceList(4)}),$("#voicebutton").click(function(){restype.val("5"),callResourceList(5)}),$("#videobutton").click(function(){restype.val("6"),callResourceList(6)}),$(document).bind("dragover",function(e){var i=$("#dropshade"),a=window.dropzoneTimeout;a?clearTimeout(a):i.addClass("in");var t=!1,o=e.target;do{if(o===i[0]){t=!0;break}o=o.parentNode}while(null!=o);t&&i.addClass("hover"),window.dropzoneTimeout=setTimeout(function(){window.dropzoneTimeout=null,i.removeClass("in hover")},100)}),$(".resource-navbar li").click(function(e){$(".resource-navbar li.active").removeClass("active");var i=$(this);i.hasClass("active")||i.addClass("active"),e.preventDefault()}),$(".resource-list").on("click",".background-form-submit-button",function(e){e.preventDefault();var i=this.form,a=$(i).find("[name=background_id]").val(),t=$(i).find("[name=background_name]").val(),o=$.ajax({url:config.base+"index.php/resource/changeBackgroundProperty",type:"POST",data:{id:a,name:t},dataType:"html"});o.done(function(e){if(1==e){$("#backgroundname_"+a).css("background","#FFFFFF");var i='<div class="alert alert-success resourcechange-notification">Change saved!</div>';$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".resourcechange-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed updating... try again later!")})}),$(".resource-list").on("click",".sprite-form-submit-button",function(e){e.preventDefault();var i=this.form,a=$(i).find("[name=sprite_id]").val(),t=$(i).find("[name=sprite_character]").val(),o=$(i).find("[name=sprite_figure]").val(),n=$(i).find("[name=sprite_expression]").val(),r=$.ajax({url:config.base+"index.php/resource/changeSpriteProperty",type:"POST",data:{id:a,character:t,figure:o,expression:n},dataType:"html"});r.done(function(e){if(1==e){$("#spritecharactername_"+a).css("background","#FFFFFF"),$("#spritefigurename_"+a).css("background","#FFFFFF"),$("#spriteexpressionname_"+a).css("background","#FFFFFF");var i='<div class="alert alert-success resourcechange-notification">Change saved!</div>';$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".resourcechange-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed updating... try again later!")})}),$(".resource-list").on("click",".bgm-form-submit-button",function(e){e.preventDefault();var i=this.form,a=$(i).find("[name=bgm_id]").val(),t=$(i).find("[name=bgm_name]").val(),o=$.ajax({url:config.base+"index.php/resource/changeAudioVideoProperty",type:"POST",data:{id:a,name:t},dataType:"html"});o.done(function(e){if(1==e){$("#bgmname_"+a).css("background","#FFFFFF");var i='<div class="alert alert-success resourcechange-notification">Change saved!</div>';$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".resourcechange-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed updating... try again later!")})}),$(".resource-list").on("click",".sfx-form-submit-button",function(e){e.preventDefault();var i=this.form,a=$(i).find("[name=sfx_id]").val(),t=$(i).find("[name=sfx_name]").val(),o=$.ajax({url:config.base+"index.php/resource/changeAudioVideoProperty",type:"POST",data:{id:a,name:t},dataType:"html"});o.done(function(e){if(1==e){$("#sfxname_"+a).css("background","#FFFFFF");var i='<div class="alert alert-success resourcechange-notification">Change saved!</div>';$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".resourcechange-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed updating... try again later!")})}),$(".resource-list").on("click",".voice-form-submit-button",function(e){e.preventDefault();var i=this.form,a=$(i).find("[name=voice_id]").val(),t=$(i).find("[name=voice_name]").val(),o=$.ajax({url:config.base+"index.php/resource/changeAudioVideoProperty",type:"POST",data:{id:a,name:t},dataType:"html"});o.done(function(e){if(1==e){$("#voicename_"+a).css("background","#FFFFFF");var i='<div class="alert alert-success resourcechange-notification">Change saved!</div>';$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".resourcechange-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed updating... try again later!")})}),$(".resource-list").on("click",".video-form-submit-button",function(e){e.preventDefault();var i=this.form,a=$(i).find("[name=video_id]").val(),t=$(i).find("[name=video_name]").val(),o=$.ajax({url:config.base+"index.php/resource/changeAudioVideoProperty",type:"POST",data:{id:a,name:t},dataType:"html"});o.done(function(e){if(1==e){$("#videoname_"+a).css("background","#FFFFFF");var i='<div class="alert alert-success resourcechange-notification">Change saved!</div>';$("#notification").append(i).hide().fadeIn(),window.setTimeout(function(){$(".resourcechange-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed updating... try again later!")})}),$(".resource-list").on("keyup","input[type=text]",function(){$(this).css("background","#FDFFD5")}),$(document).ready(callResourceList(1)),$(".resource-list").on("click",".sprite-form-delete-button, .sprite-form-remove-button",function(e){e.preventDefault();var i=$(this.form),a=$(this.form).find("[name=sprite_id]").val(),t=$.ajax({url:config.base+"index.php/resource/removeResource",type:"POST",data:{id:a},dataType:"html"});t.done(function(e){if(1==e){$(i).closest(".sprite-media, .sprite-thumbnail-image").remove();var a='<div class="alert alert-warning resourceremove-notification">Resource deleted!</div>';$("#notification").append(a).hide().fadeIn(),window.setTimeout(function(){$(".resourceremove-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed deleting... try again later!")})}),$(".resource-list").on("click",".background-form-delete-button",function(e){e.preventDefault();var i=$(this.form),a=$(this.form).find("[name=background_id]").val(),t=$.ajax({url:config.base+"index.php/resource/removeResource",type:"POST",data:{id:a},dataType:"html"});t.done(function(e){if(1==e){$(i).closest(".background-media").remove();var a='<div class="alert alert-warning resourceremove-notification">Resource deleted!</div>';$("#notification").append(a).hide().fadeIn(),window.setTimeout(function(){$(".resourceremove-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed deleting... try again later!")})}),$(".resource-list").on("click",".bgm-form-delete-button",function(e){e.preventDefault();var i=$(this.form),a=$(this.form).find("[name=bgm_id]").val(),t=$.ajax({url:config.base+"index.php/resource/removeResource",type:"POST",data:{id:a},dataType:"html"});t.done(function(e){if(1==e){$(i).closest("tr").remove();var a='<div class="alert alert-warning resourceremove-notification">Resource deleted!</div>';$("#notification").append(a).hide().fadeIn(),window.setTimeout(function(){$(".resourceremove-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed deleting... try again later!")})}),$(".resource-list").on("click",".sfx-form-delete-button",function(e){e.preventDefault();var i=$(this.form),a=$(this.form).find("[name=sfx_id]").val(),t=$.ajax({url:config.base+"index.php/resource/removeResource",type:"POST",data:{id:a},dataType:"html"});t.done(function(e){if(1==e){$(i).closest("tr").remove();var a='<div class="alert alert-warning resourceremove-notification">Resource deleted!</div>';$("#notification").append(a).hide().fadeIn(),window.setTimeout(function(){$(".resourceremove-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed deleting... try again later!")})}),$(".resource-list").on("click",".voice-form-delete-button",function(e){e.preventDefault();var i=$(this.form),a=$(this.form).find("[name=voice_id]").val(),t=$.ajax({url:config.base+"index.php/resource/removeResource",type:"POST",data:{id:a},dataType:"html"});t.done(function(e){if(1==e){$(i).closest("tr").remove();var a='<div class="alert alert-warning resourceremove-notification">Resource deleted!</div>';$("#notification").append(a).hide().fadeIn(),window.setTimeout(function(){$(".resourceremove-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed deleting... try again later!")})}),$(".resource-list").on("click",".video-form-delete-button",function(e){e.preventDefault();var i=$(this.form),a=$(this.form).find("[name=video_id]").val(),t=$.ajax({url:config.base+"index.php/resource/removeResource",type:"POST",data:{id:a},dataType:"html"});t.done(function(e){if(1==e){$(i).closest("tr").remove();var a='<div class="alert alert-warning resourceremove-notification">Resource deleted!</div>';$("#notification").append(a).hide().fadeIn(),window.setTimeout(function(){$(".resourceremove-notification").fadeTo(500,0,function(){$(this).remove()})},5e3)}else callErrorNotification("Failed deleting... try again later!")})});